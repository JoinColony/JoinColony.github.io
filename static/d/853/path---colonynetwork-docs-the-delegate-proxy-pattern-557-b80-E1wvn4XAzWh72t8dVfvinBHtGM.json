{"data":{"doc":{"editUrl":"https://github.com/JoinColony/colonyNetwork/edit/develop/docs/_Docs_Upgrades.md","frontmatter":{"title":"The Delegate Proxy Pattern"},"htmlAst":{"type":"root","children":[{"type":"element","tagName":"ul","properties":{"className":["md-toc"]},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#for-whom-the-delegate-calls"},"children":[{"type":"text","value":"For whom the delegate calls"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#it-calls-for-roleid"},"children":[{"type":"text","value":"It calls for roleId"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The contracts comprising the Colony Network are upgradeable using the Delegate Proxy design pattern."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Providing an upgrade path is important to allow for the continuous improvement of the Colony Network. At the same time, all depreciated versions of Colony should remain functional indefinitely after deployment, so that the organizations created are not predicated upon the actions/efforts of a third party."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In other words, upgrades to any individual colony on the network are \"opt-in\", while the network as a whole remains eternally backwards-compatible."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"for-whom-the-delegate-calls"},"children":[{"type":"element","tagName":"a","properties":{"href":"#for-whom-the-delegate-calls","ariaLabel":"for whom the delegate calls permalink","className":["md-heading-link"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"For whom the delegate calls"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Interacting with both the Colony Network and individual colonies on the network is somewhat different than many other smart contract interactions that a blockchain developer might not be accustomed to."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Rather than calling functions directly from the contract in which they are deployed, all transactions are signed and sent to the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"EtherRouter"}]},{"type":"text","value":" contract."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Whenever a transaction is received by the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"EtherRouter"}]},{"type":"text","value":" contract, it looks the function up in a "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Resolver"}]},{"type":"text","value":" contract, using the function signature."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Resolver"}]},{"type":"text","value":" contract contains a mapping of whitelisted function signatures to addresses ("},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"mapping ( bytes4 => address )"}]},{"type":"text","value":")."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"A function signature lookup will return the address of the contracts that implement the desired function. "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"EtherRouter"}]},{"type":"text","value":" in turn calls the function via "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"delegatecall"}]},{"type":"text","value":", and passes any returns from the call back to "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"msg.sender"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"img/delegateProxyCallchain_1.png","alt":"EtherRouter"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This pattern enables both fine-grained control of permissions for individual functions (see below), well as eternal backwards-compatibility following network upgrades. To learn more about planned upgrades to the Colony Network, please see "},{"type":"element","tagName":"a","properties":{"href":"/colonynetwork/docs-releases/"},"children":[{"type":"text","value":"Releases"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"it-calls-for-roleid"},"children":[{"type":"element","tagName":"a","properties":{"href":"#it-calls-for-roleid","ariaLabel":"it calls for roleid permalink","className":["md-heading-link"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"It calls for "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"roleId"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Most functions in colony are "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"authorized"}]},{"type":"text","value":" by a separate contract which defines the rules for who can call which functions. Any function that is decorated with the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"auth"}]},{"type":"text","value":" modifier will perform an authorization check before granting access to the function."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In the current Glider release, authority is based on roles, which are defined in the relevant \"authority\" contracts, e.g. "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"ColonyAuthority.sol"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Roles within Colony act as a white-list for functions, registering specific addresses to a "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Founder"}]},{"type":"text","value":" or "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Admin"}]},{"type":"text","value":" role, approved to call a certain set of functions within a colony."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Roles also are used in task-level permissions. A more specific example of task roles can be seen in the "},{"type":"element","tagName":"a","properties":{"href":"https://docs.colony.io/colonyjs/topics-task-lifecycle/#task-roles"},"children":[{"type":"text","value":"task workflow"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In future releases, this pattern will allow for reputation-mediated authority in Colony."}]}],"data":{"quirksMode":false}}},"project":{"slug":"colonynetwork","name":"colonyNetwork","logo":"img/colonyNetwork_color.svg","logoSmall":"img/logomark_colonyNetwork_blue.svg","repoUrl":"https://github.com/JoinColony/colonyNetwork","sectionOrder":["intro","docs","bug-bounty-program","whitepaper-tldr","api"],"sectionTranslations":null,"sections":[{"name":"Docs","slug":"docs","docs":[{"slug":"extensions","fields":{"locale":"en","slug":"/colonynetwork/docs-extensions"},"frontmatter":{"title":"Extensions","order":5,"section":"Docs"}},{"slug":"get-started","fields":{"locale":"en","slug":"/colonynetwork/docs-get-started"},"frontmatter":{"title":"Get Started","order":7,"section":"Docs"}},{"slug":"overview","fields":{"locale":"en","slug":"/colonynetwork/docs-overview"},"frontmatter":{"title":"Overview","order":1,"section":"Docs"}},{"slug":"modular-permissions","fields":{"locale":"en","slug":"/colonynetwork/docs-modular-permissions"},"frontmatter":{"title":"Modular Permissions","order":4,"section":"Docs"}},{"slug":"releases","fields":{"locale":"en","slug":"/colonynetwork/docs-releases"},"frontmatter":{"title":"Releases","order":3,"section":"Docs"}},{"slug":"reputation-mining-client","fields":{"locale":"en","slug":"/colonynetwork/docs-reputation-mining-client"},"frontmatter":{"title":"Reputation Mining Client","order":6,"section":"Docs"}},{"slug":"the-delegate-proxy-pattern","fields":{"locale":"en","slug":"/colonynetwork/docs-the-delegate-proxy-pattern"},"frontmatter":{"title":"The Delegate Proxy Pattern","order":2,"section":"Docs"}}]},{"name":"Intro","slug":"intro","docs":[{"slug":"welcome","fields":{"locale":"en","slug":"/colonynetwork/intro-welcome"},"frontmatter":{"title":"Welcome","order":0,"section":"Intro"}}]},{"name":"Whitepaper TL;DR","slug":"whitepaper-tldr","docs":[{"slug":"colony","fields":{"locale":"en","slug":"/colonynetwork/whitepaper-tldr-colony"},"frontmatter":{"title":"Colony","order":0,"section":"Whitepaper TL;DR"}},{"slug":"objections-and-disputes","fields":{"locale":"en","slug":"/colonynetwork/whitepaper-tldr-objections-and-disputes"},"frontmatter":{"title":"Objections and Disputes","order":7,"section":"Whitepaper TL;DR"}},{"slug":"domains-and-skills","fields":{"locale":"en","slug":"/colonynetwork/whitepaper-tldr-domains-and-skills"},"frontmatter":{"title":"Domains and Skills","order":5,"section":"Whitepaper TL;DR"}},{"slug":"glossary-of-terms","fields":{"locale":"en","slug":"/colonynetwork/whitepaper-tldr-glossary-of-terms"},"frontmatter":{"title":"Glossary of Terms","order":11,"section":"Whitepaper TL;DR"}},{"slug":"the-meta-colony-and-clny","fields":{"locale":"en","slug":"/colonynetwork/whitepaper-tldr-the-meta-colony-and-clny"},"frontmatter":{"title":"The Meta Colony and CLNY","order":8,"section":"Whitepaper TL;DR"}},{"slug":"pots-and-funding","fields":{"locale":"en","slug":"/colonynetwork/whitepaper-tldr-pots-and-funding"},"frontmatter":{"title":"Pots and Funding","order":6,"section":"Whitepaper TL;DR"}},{"slug":"reputation","fields":{"locale":"en","slug":"/colonynetwork/whitepaper-tldr-reputation"},"frontmatter":{"title":"Reputation","order":4,"section":"Whitepaper TL;DR"}},{"slug":"reputation-mining","fields":{"locale":"en","slug":"/colonynetwork/whitepaper-tldr-reputation-mining"},"frontmatter":{"title":"Reputation Mining","order":9,"section":"Whitepaper TL;DR"}},{"slug":"tasks-and-payments","fields":{"locale":"en","slug":"/colonynetwork/whitepaper-tldr-tasks-and-payments"},"frontmatter":{"title":"Tasks and Payments","order":3,"section":"Whitepaper TL;DR"}}]},{"name":"Bug Bounty Program","slug":"bug-bounty-program","docs":[{"slug":"overview","fields":{"locale":"en","slug":"/colonynetwork/bug-bounty-program-overview"},"frontmatter":{"title":"Overview","order":0,"section":"Bug Bounty Program"}},{"slug":"terms-and-conditions","fields":{"locale":"en","slug":"/colonynetwork/bug-bounty-program-terms-and-conditions"},"frontmatter":{"title":"Terms and Conditions","order":1,"section":"Bug Bounty Program"}}]}]},"allProject":{"edges":[{"node":{"name":"colonyNetwork"}},{"node":{"name":"colonyJS"}},{"node":{"name":"colonyStarter"}},{"node":{"name":"purser"}},{"node":{"name":"tailor"}}]}},"pageContext":{"isCreatedByStatefulCreatePages":false,"docId":"12c41d59-393b-5622-b7cb-efbf792a4aa3","projectName":"colonyNetwork"}}